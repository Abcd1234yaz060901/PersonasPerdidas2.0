@*@model PersonasPerdidas.Models.Camara

@{
    ViewBag.Title = "Create";
}*@
    <script src="~/Scripts/src/camara.js"></script>

@*<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>*@

@*<CENTER>
    <h2 class="page-section-heading text-center text-uppercase text-secondary mb-0" style="font-weight: bold;font-family:'Californian'">Configuracion Camaras</h2>
    <hr />
    <h4 style="font-weight:bold">Camaras</h4>
    <hr />


    @using (Html.BeginForm("Create", "Camaras", new { rol = ViewBag.Rol, Usuario = ViewBag.UsuarioActual, NombreUsuario = ViewBag.NombreUsuario, Correo = ViewBag.Correo }, FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()

       

        @Html.ValidationSummary(true, "", new { @class = "text-danger" })


    
        <input type="file" name="imagen" capture="camera">
        <hr />
        @Html.ValidationMessageFor(model => model.foto, "", new { @class = "text-danger" })

      
        <input type="submit" value="Enviar" class="btn btn-default" />

      
    }
    </br></br>
</CENTER>*@


@*@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}*@
@*<link href="~/Content/Camara.css" rel="stylesheet" />
    <script>
        //Nos aseguramos que estén definidas
        //algunas funciones básicas
        window.URL = window.URL || window.webkitURL;
        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia ||
            function () {
                alert('Su navegador no soporta navigator.getUserMedia().');
            };

        //Este objeto guardará algunos datos sobre la cámara
        window.datosVideo = {
            'StreamVideo': null,
            'url': null
        }

        jQuery('#botonIniciar').on('click', function (e) {

            //Pedimos al navegador que nos da acceso a
            //algún dispositivo de video (la webcam)
            navigator.getUserMedia({
                'audio': false,
                'video': true
            }, function (streamVideo) {
                datosVideo.StreamVideo = streamVideo;
                datosVideo.url = window.URL.createObjectURL(streamVideo);
                jQuery('#camara').attr('src', datosVideo.url);

            }, function () {
                alert('No fue posible obtener acceso a la cámara.');
            });

        });

        jQuery('#botonDetener').on('click', function (e) {

            if (datosVideo.StreamVideo) {
                datosVideo.StreamVideo.stop();
                window.URL.revokeObjectURL(datosVideo.url);
            }

        });

        jQuery('#botonFoto').on('click', function (e) {
            var oCamara, oFoto, oContexto, w, h;

            oCamara = jQuery('#camara');
            oFoto = jQuery('#foto');
            w = oCamara.width();
            h = oCamara.height();
            oFoto.attr({
                'width': w,
                'height': h
            });
            oContexto = oFoto[0].getContext('2d');
            oContexto.drawImage(oCamara[0], 0, 0, w, h);

        });
    </script>

    <script src="~/Scripts/src/camara.js"></script>
    <div id='botonera'>
        <input id='botonIniciar' type='button' value='Iniciar'></input>
        <input id='botonDetener' type='button' value='Detener'></input>
        <input id='botonFoto' type='button' value='Foto'></input>
    </div>
    <div class="contenedor">
        <div class="titulo">Cámara</div>
        <video id="camara" autoplay controls></video>
    </div>
    <div class="contenedor">
        <div class="titulo">Foto</div>
        <canvas id="foto"></canvas>
    </div>*@
